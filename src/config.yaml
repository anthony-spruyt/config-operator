# yaml-language-server: $schema=https://raw.githubusercontent.com/anthony-spruyt/xfg/main/config-schema.json
id: repo-operator

deleteOrphaned: true

prOptions:
  merge: manual

repos:
  #- git: https://github.com/anthony-spruyt/bai2csv.git
  - git: https://github.com/anthony-spruyt/claude-config.git
    prOptions:
      merge: auto
      mergeStrategy: squash
      deleteBranch: true
    files:
      .devcontainer/devcontainer.json:
        content:
          customizations:
            vscode:
              $arrayMerge: append
              extensions:
                - "jetmartin.bats"
      .hadolint.yaml: false
  - git: https://github.com/anthony-spruyt/container-images.git
    prOptions:
      merge: manual
    files:
      .mega-linter.yml:
        content: |-
          # yaml-language-server: $schema=https://raw.githubusercontent.com/oxsecurity/megalinter/main/megalinter/descriptors/schemas/megalinter-configuration.jsonschema.json
          # Project-specific MegaLinter configuration
          # Extends the base config from repo-operator
          # Add custom linters or overrides below
          EXTENDS:
            - .mega-linter-base.yml
          # Append additional linters to base config (don't replace)
          CONFIG_PROPERTIES_TO_APPEND:
            - ENABLE_LINTERS
          # Add project-specific linters below:
          ENABLE_LINTERS:
            - DOCKERFILE_HADOLINT
      lint-config.sh:
        content: |-
          #!/usr/bin/env bash
          # shellcheck disable=SC2034 # Variables used by sourcing script (lint.sh)
          # Lint configuration - customize per repository
          # This file is sourced by lint.sh for both local and CI runs

          # MegaLinter Docker image (use digest for reproducibility)
          # renovate: TODO
          MEGALINTER_IMAGE="ghcr.io/anthony-spruyt/megalinter-container-images@sha256:a96ce561aec6be236738b812fc3aad5ff20d15e648404ca19408b092d37d7e75"

          # Skip linting for renovate/dependabot commits in CI
          SKIP_BOT_COMMITS=true

          # MegaLinter flavor (use "all" for custom images to bypass flavor validation)
          MEGALINTER_FLAVOR="all"
  #- git: https://github.com/anthony-spruyt/firemerge.git
  #- git: https://github.com/anthony-spruyt/gastown-dev.git
  - git: https://github.com/anthony-spruyt/repo-operator.git
    prOptions:
      merge: direct
    files:
      .hadolint.yaml: false
      .pylintrc: false
  #- git: https://github.com/anthony-spruyt/spruyt-labs.git
  #- git: https://github.com/anthony-spruyt/SunGather.git
  #- git: https://github.com/anthony-spruyt/xfg.git

files:
  .devcontainer/devcontainer.json:
    content: "@templates/.devcontainer/devcontainer.json"
  .devcontainer/package.json:
    content: "@templates/.devcontainer/package.json"
  .devcontainer/post-create.sh:
    content: "@templates/.devcontainer/post-create.sh"
  .devcontainer/setup-devcontainer.sh:
    createOnly: true
    content: "@templates/.devcontainer/setup-devcontainer.sh"
  .github/rulesets/pr-rules.json:
    content: "@templates/.github/rulesets/pr-rules.json"
  .github/rulesets/push-protection.json:
    content: "@templates/.github/rulesets/push-protection.json"
  .github/workflows/ci.yaml:
    createOnly: true
    schemaUrl: https://raw.githubusercontent.com/SchemaStore/schemastore/master/src/schemas/json/github-workflow.json
    header: See https://github.com/anthony-spruyt/repo-operator/blob/main/src/templates/.github/workflows/ci.yaml for template comments
    content: "@templates/.github/workflows/ci.yaml"
  .github/workflows/trivy-scan.yaml:
    createOnly: true
    schemaUrl: https://raw.githubusercontent.com/SchemaStore/schemastore/master/src/schemas/json/github-workflow.json
    header: See https://github.com/anthony-spruyt/repo-operator/blob/main/src/templates/.github/workflows/trivy-scan.yaml for template comments
    content: "@templates/.github/workflows/trivy-scan.yaml"
  .github/renovate.json5:
    createOnly: true
    content: "@templates/.github/renovate.json5"
  .github/apply-rulesets.sh:
    content: "@templates/.github/apply-rulesets.sh"
  .github/actionlint.yaml:
    createOnly: true
    header:
      - https://github.com/rhysd/actionlint/blob/main/docs/config.md
      - Ignore shellcheck warnings in all workflows
      - "SC2153: Uppercase env vars from GitHub Actions workflow env blocks"
      - "SC2034: Variables used in heredocs appear unused"
    content: "@templates/.github/actionlint.yaml"
  .vscode/settings.json:
    createOnly: true
    content: "@templates/.vscode/settings.json"
  .editorconfig:
    content: "@templates/.editorconfig"
  .gitignore:
    createOnly: true
    content: "@templates/.gitignore"
  .hadolint.yaml:
    createOnly: true
    content: "@templates/.hadolint.yaml"
  .lycheeignore:
    createOnly: true
  .markdownlint.json:
    content: "@templates/.markdownlint.json"
  .markdownlintignore:
    createOnly: true
    content: "@templates/.markdownlintignore"
  .mega-linter-base.yml:
    schemaUrl: https://raw.githubusercontent.com/oxsecurity/megalinter/main/megalinter/descriptors/schemas/megalinter-configuration.jsonschema.json
    header:
      - Base MegaLinter configuration synced from repo-operator
      - This file is automatically updated - do not modify directly
      - To add custom linters, modify .mega-linter.yml instead
    content: "@templates/.mega-linter-base.yml"
  .mega-linter.yml:
    createOnly: true
    schemaUrl: https://raw.githubusercontent.com/oxsecurity/megalinter/main/megalinter/descriptors/schemas/megalinter-configuration.jsonschema.json
    header:
      - Project-specific MegaLinter configuration
      - Extends the base config from repo-operator
      - Add custom linters or overrides below
      - "Add project-specific linters below:"
      - "ENABLE_LINTERS:"
      - "  - TYPESCRIPT_ES"
      - "  - PYTHON_PYLINT"
    content: "@templates/.mega-linter.yml"
  .pre-commit-config.yaml:
    schemaUrl: https://raw.githubusercontent.com/SchemaStore/schemastore/master/src/schemas/json/pre-commit-config.json
    content: "@templates/.pre-commit-config.yaml"
  .prettierignore:
    createOnly: true
  .prettierrc.yaml:
    schemaUrl: https://raw.githubusercontent.com/SchemaStore/schemastore/master/src/schemas/json/prettierrc.json
    header: This file is automatically updated - do not modify directly
    content: "@templates/.prettierrc.yaml"
  .pylintrc:
    createOnly: true
  .shellcheckrc:
    createOnly: true
  .trivyignore.yaml:
    createOnly: true
    header:
      - Path-specific trivy ignores
      - https://trivy.dev/latest/docs/configuration/filtering
    content: "@templates/.trivyignore.yaml"
  .yamllint.yml:
    schemaUrl: https://raw.githubusercontent.com/SchemaStore/schemastore/master/src/schemas/json/yamllint.json
    header:
      - This file is automatically updated - do not modify directly
      - https://yamllint.readthedocs.io/en/latest/configuration.html
    content: "@templates/.yamllint.yml"
  LICENSE:
    content: "@templates/LICENSE.MIT"
  lint-config.sh:
    createOnly: true
    content: "@templates/lint-config.sh"
  lint.sh:
    content: "@templates/lint.sh"
  trivy.yaml:
    schemaUrl: https://raw.githubusercontent.com/aquasecurity/trivy/main/schema/trivy-config.json
    header:
      - This file is automatically updated - do not modify directly
      - https://trivy.dev/latest/docs/references/configuration/config-file/
    content: "@templates/trivy.yaml"
